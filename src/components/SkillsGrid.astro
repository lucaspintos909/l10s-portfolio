---
import type { CollectionEntry } from "astro:content";
import type { Locale } from "../i18n/index";
import { ui } from "../i18n/ui";

interface Props {
    groups: CollectionEntry<"skills">[];
    lang: Locale;
}

const { groups, lang } = Astro.props;
const t = (key: keyof typeof ui["es"]) => ui[lang][key] ?? ui["es"][key];

const sorted = [...groups].sort((a, b) => a.data.order - b.data.order);
---

<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    {
        sorted.map((group) => (
            <div class="cv-card flex flex-col gap-3">
                <h3
                    class="font-mono text-2xs font-semibold uppercase tracking-widest"
                    style="color: var(--color-text-muted);"
                >
                    {group.data.category}
                </h3>
                <ul class="flex flex-col gap-2" role="list">
                    {group.data.items.map(
                        (item: {
                            name: string;
                            level?: string;
                            icon?: string;
                        }) => (
                            <li class="flex items-center justify-between gap-2">
                                <span class="text-sm font-mono">
                                    {item.name}
                                </span>
                                {item.level && (
                                    <span
                                        class="font-mono text-2xs px-1.5 py-0.5 rounded"
                                        style="color: var(--color-text-muted); background-color: var(--color-bg);"
                                        title={t(
                                            `skills.level.${item.level}` as keyof typeof ui["es"]
                                        )}
                                        aria-label={t(
                                            `skills.level.${item.level}` as keyof typeof ui["es"]
                                        )}
                                    >
                                        {t(
                                            `skills.level.${item.level}` as keyof typeof ui["es"]
                                        )}
                                    </span>
                                )}
                            </li>
                        )
                    )}
                </ul>
            </div>
        ))
    }
</div>
